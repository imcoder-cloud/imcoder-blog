webpackJsonp([10],{"5NVW":function(e,t){},fDLC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("0mZY"),s=a("sNer"),l={data:function(){return{optionsArr:["total","sizes","prev","pager","next","jumper"],roles:[],fileList:[],tableData:[],groups:[],editParams:{},queryParams:{pageNum:1,pageSize:10},total:0}},created:function(){this.getUsers(),this.getRoles()},computed:{editTypeChange:function(){return this.editType}},watch:{},methods:{getUsers:function(){var e=this;""==this.queryParams.name&&(this.queryParams.name=null),r.a.page(this.queryParams).then(function(t){e.tableData=t.data.records,e.total=t.data.total})},getRoles:function(){var e=this;s.a.findAll().then(function(t){e.roles=t.data})},handleSizeChange:function(e){this.queryParams.pageSize=e,this.getUsers()},handleCurrentChange:function(e){this.queryParams.pageNum=e,this.getUsers()},onSuccess:function(e,t,a){t.url=e.data.url,this.fileList=a},handleRemove:function(e,t){this.fileList=t},save:function(e){var t=this;return this.editParams.username?this.editParams.nickname?0==this.editParams.roleIds.length?(this.$message.warning("请选择角色"),!1):(this.fileList.length>0&&(this.editParams.avatar=this.fileList[0].url),void r.a.save(this.editParams).then(function(e){t.getUsers(),t.$message.success("保存成功"),t.reset()})):(this.$message.warning("请填写昵称"),!1):(this.$message.warning("请填写用户名"),!1)},edit:function(e){this.editParams=e,this.editParams.roleIds=e.roleIdStr.split(",").map(function(e){return parseInt(e)}),e.avatar&&(this.fileList=[{name:e.avatar.split("@@")[1],url:e.avatar}])},del:function(e){var t=this;r.a.delete(e.id).then(function(e){t.$message.success("已删除"),t.getUsers()})},reset:function(){this.editParams={},this.fileList=[]}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticClass:"mb20",attrs:{xl:6,lg:6,md:10,sm:24,xs:24}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("用户编辑")])]),e._v(" "),a("div",[a("el-form",{staticClass:"vertical-form",attrs:{model:e.editParams,"label-position":"left","label-width":"80px"}},[a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.editParams.username,callback:function(t){e.$set(e.editParams,"username",t)},expression:"editParams.username"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("el-input",{attrs:{placeholder:"昵称"},model:{value:e.editParams.nickname,callback:function(t){e.$set(e.editParams,"nickname",t)},expression:"editParams.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"角色"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择角色"},model:{value:e.editParams.roleIds,callback:function(t){e.$set(e.editParams,"roleIds",t)},expression:"editParams.roleIds"}},e._l(e.roles,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"邮箱"}},[a("el-input",{attrs:{placeholder:"邮箱"},model:{value:e.editParams.email,callback:function(t){e.$set(e.editParams,"email",t)},expression:"editParams.email"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"描述"},model:{value:e.editParams.description,callback:function(t){e.$set(e.editParams,"description",t)},expression:"editParams.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"头像"}},[a("el-upload",{attrs:{action:"/api/admin/upload/image","on-remove":e.handleRemove,"on-success":e.onSuccess,"file-list":e.fileList,limit:1,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.save()}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)],1)],1)])],1),e._v(" "),a("el-col",{staticClass:"mb20",attrs:{xl:18,lg:18,md:14,sm:24,xs:24}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("用户列表")])]),e._v(" "),a("div",[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"用户名称"}},[a("el-input",{attrs:{placeholder:"用户名称"},model:{value:e.queryParams.name,callback:function(t){e.$set(e.queryParams,"name",t)},expression:"queryParams.name"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getUsers()}}},[e._v("查询")])],1)],1)],1),e._v(" "),a("div",{staticStyle:{padding:"20px"}},[a("el-table",{staticStyle:{"margin-bottom":"20px"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{label:"头像",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{height:"60px"},attrs:{src:e.row.avatar,fit:"scale-down"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"nickname",label:"昵称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleNames",label:"角色"}}),e._v(" "),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定删除本条数据吗？删除后不可恢复。",cancelButtonType:"default"},on:{onConfirm:function(a){return e.del(t.row)}}},[a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1)]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:!1,"current-page":e.queryParams.pageNum,"page-sizes":[10,20,30,40,50],"page-size":e.queryParams.pageSize,layout:e.optionsArr.join(","),total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1)],1)],1)},staticRenderFns:[]};var n=a("VU/8")(l,i,!1,function(e){a("5NVW")},null,null);t.default=n.exports},sNer:function(e,t,a){"use strict";var r=a("vLgD"),s="/api/admin/role",l={findAll:function(e){return Object(r.a)({url:""+s,params:e,method:"get"})},page:function(e){return Object(r.a)({url:s+"/page",params:e,method:"get"})},get:function(e){return Object(r.a)({url:s+"/"+e,method:"get"})},tree:function(){return Object(r.a)({url:s+"/tree",method:"get"})},create:function(e){return Object(r.a)({url:""+s,data:[e],method:"post"})},update:function(e){return Object(r.a)({url:""+s,data:[e],method:"put"})},delete:function(e){return Object(r.a)({url:s+"/"+e,method:"delete"})}};t.a=l}});