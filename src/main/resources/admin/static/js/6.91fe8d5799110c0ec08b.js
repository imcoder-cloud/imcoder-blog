webpackJsonp([6],{"9q7c":function(e,t){},EatH:function(e,t,a){"use strict";var s={name:"el-tree-select",props:{config:{type:Object,default:function(){return{value:"id",label:"title",children:"children"}}},defaultOption:{type:Object,default:function(){return{value:null,label:"请选择"}}},options:{type:Array,default:function(){return[]}},value:{type:Number,default:function(){return null}},clearable:{type:Boolean,default:function(){return!1}},accordion:{type:Boolean,default:function(){return!0}},placeholder:{type:String,default:function(){return"搜索关键字"}}},data:function(){return{filterText:"",valueId:this.value,valueTitle:"",treeData:[],defaultExpandedKey:[]}},mounted:function(){var e=this;this.treeData.push(this.defaultOption),this.options.map(function(t){e.treeData.push(t)}),this.initHandle()},methods:{initHandle:function(){void 0!=this.value&&null!=this.value?(this.valueTitle=this.$refs.selectTree.getNode(this.value).data[this.config.label],this.$refs.selectTree.setCurrentKey(this.value),this.defaultExpandedKey=[this.value]):this.clearHandle()},nodeClick:function(e){this.valueTitle=e[this.config.label],this.value=e[this.config.value],this.$emit("node-click",e),this.defaultExpandedKey=[]},clearHandle:function(){this.valueTitle="",this.value=null,this.defaultExpandedKey=[],this.clearSelected(),this.$emit("getValue",null)},clearSelected:function(){document.querySelectorAll(".select-tree #tree-option .el-tree-node").forEach(function(e){return e.classList.remove("is-current")})},filterNode:function(e,t){return!e||-1!==t.name.indexOf(e)}},watch:{value:function(e){this.initHandle()},filterText:function(e){this.$refs.selectTree.filter(e)}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"select-tree"},[a("el-select",{ref:"select",attrs:{value:e.value,clearable:e.clearable},on:{clear:e.clearHandle}},[a("el-input",{staticClass:"select-input",attrs:{placeholder:e.placeholder,size:"small"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-option",{attrs:{value:e.value,label:e.valueTitle}},[a("el-tree",{ref:"selectTree",attrs:{id:"tree-option",accordion:e.accordion,data:e.treeData,props:e.config,"node-key":e.config.value,"default-expanded-keys":e.defaultExpandedKey,"filter-node-method":e.filterNode},on:{"node-click":e.nodeClick}})],1)],1)],1)},staticRenderFns:[]};var i=a("VU/8")(s,l,!1,function(e){a("Qg02")},"data-v-3a77c360",null);t.a=i.exports},"JDI/":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Gu7T"),l=a.n(s),i=a("EatH"),n=a("Dd8w"),r=a.n(n),o=a("pFYg"),c=a.n(o),d={name:"imcoderTreeSelect",data:function(){return{selecteds:[],options_show:!1,checked_keys:[],width:"100%"}},props:{data:{type:Array,default:function(){return[]}},props:{type:Object,default:function(){return{}}},nodeKey:{type:String,default:"id"},value:[String,Number,Array,Object],checkbox:{type:Boolean,default:!1},collapseTags:{type:Boolean,default:!1},leaf:{type:Boolean,default:!1},trigger:{type:String,default:"click"},disabled:{type:Boolean,default:!1},nowrap:{type:Boolean,default:!1},noCheckedClose:{type:Boolean,default:!1},placeholder:{type:String,default:"请选择"},size:{type:String,default:"medium"},defaultExpandAll:{type:Boolean,default:!0},defaultExpandedKeys:{type:Array,default:function(){return[]}}},model:{prop:"value",event:"change"},methods:{handleCheckChange:function(e,t){t.checkedNodes;var a=t.checkedKeys,s=this.$refs["tree-select"].getCheckedNodes(this.leaf);this.selecteds=s,this.$emit("change",s),0===a.length&&this.noCheckedClose&&(this.options_show=!1)},treeItemClick:function(e,t){this.checkbox||this.leaf&&!t.isLeaf||(this.selecteds=[e],this.options_show=!1,this.$emit("change",this.selecteds))},tabClose:function(e){this.disabled||(this.checkbox?(this.$refs["tree-select"].setChecked(e,!1,!0),this.selecteds=this.$refs["tree-select"].getCheckedNodes(),0===this.selecteds.length&&this.noCheckedClose&&(this.options_show=!1)):(this.selecteds=[],this.$refs["tree-select"].setCurrentKey(null),this.options_show=!1),this.$emit("change",this.selecteds))},clear:function(){this.selecteds=[]},chaeckDefaultValue:function(){var e=this,t=this.value;if(!t&&0!=t||Array.isArray(t)&&0===t.length){if(this.selecteds=[],!this.checkbox)return;return this.checked_keys=[],void this.$nextTick(function(){e.$refs["tree-select"].setCheckedKeys([])})}if(this.checkbox)return this.checked_keys="object"===c()(t[0])?t.map(function(t){return t[e.nodeKey]}):t,void this.$nextTick(function(){e.selecteds=e.$refs["tree-select"].getCheckedNodes(e.leaf)});if("object"===(void 0===t?"undefined":c()(t))){var a=Array.isArray(t)?t[0]:t;this.selecteds=[a],this.$nextTick(function(){e.$refs["tree-select"].setCurrentNode(a)})}else this.$nextTick(function(){e.$refs["tree-select"].setCurrentKey(t);var a=e.$refs["tree-select"].getCurrentNode();e.selecteds=a?[a]:[]})},closeOptions:function(){this.options_show=!1}},created:function(){this.chaeckDefaultValue()},mounted:function(){var e=document.getElementsByClassName("imcoder-tree-select")[0].getBoundingClientRect().width;this.width=e},watch:{value:function(e){this.chaeckDefaultValue()}},computed:{selfData:function(){return this.data},selfProps:function(){return r()({label:"name",children:"children",disabled:function(e){return e.disabled}},this.props)},sizeClass:function(){var e="size-medium";switch(this.size){case"medium":e="size-medium";break;case"small":e="size-small";break;case"default":e="size-default";break;case"mini":e="size-mini";break;default:e="size-medium"}return e},collapseTagsItem:function(){return this.selecteds[0]||{}}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"imcoder-tree-select",style:{width:e.width}},[a("el-popover",{ref:"treeContent",attrs:{placement:"bottom",width:e.width,trigger:e.trigger,disabled:e.disabled,transition:"fade-in","popper-class":"imcoder-tree-popper"},model:{value:e.options_show,callback:function(t){e.options_show=t},expression:"options_show"}},[a("el-scrollbar",{staticClass:"imcoder-tree-content"},[a("div",{staticClass:"imcoder-tree-body"},[a("el-tree",{ref:"tree-select",staticClass:"imcoder-options-tree",attrs:{"highlight-current":"",data:e.selfData,props:e.selfProps,"node-key":e.nodeKey,"show-checkbox":e.checkbox,"expand-on-click-node":!1,"default-checked-keys":e.checked_keys,"default-expand-all":e.defaultExpandAll,"default-expanded-keys":e.defaultExpandedKeys},on:{check:e.handleCheckChange,"node-click":e.treeItemClick}})],1)]),e._v(" "),a("div",{staticClass:"selected-box",class:[{"imcoder-disabled":e.disabled,"no-wrap":e.nowrap},e.sizeClass],attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"tag-box"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.selecteds.length>0,expression:"selecteds.length > 0"}]},[e.collapseTags?[a("el-tag",{staticClass:"imcoder-select-tag",attrs:{closable:"",size:e.size,title:e.collapseTagsItem[e.selfProps.label]},on:{close:function(t){return e.tabClose(e.collapseTagsItem[e.nodeKey])}}},[e._v(e._s(e.collapseTagsItem[e.selfProps.label]))]),e._v(" "),this.selecteds.length>1?a("el-tag",{staticClass:"imcoder-select-tag",attrs:{size:e.size}},[e._v("+"+e._s(this.selecteds.length-1))]):e._e()]:e._l(e.selecteds,function(t){return a("el-tag",{key:t[e.nodeKey],staticClass:"imcoder-select-tag",attrs:{closable:"",size:e.size,title:t[e.selfProps.label]},on:{close:function(a){return e.tabClose(t[e.nodeKey])}}},[e._v(e._s(t[e.selfProps.label]))])})],2),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.selecteds.length,expression:"selecteds.length == 0"}],staticClass:"imcoder-placeholder-box"},[e._v(e._s(e.placeholder))])]),e._v(" "),a("div",{staticClass:"icon-box"},[a("transition",{attrs:{name:"fade-rotate",mode:"out-in"}},[e.options_show?a("i",{key:"btm",staticClass:"el-icon-arrow-up"}):a("i",{key:"top",staticClass:"el-icon-arrow-down"})])],1)])],1)],1)},staticRenderFns:[]};var f=a("VU/8")(d,u,!1,function(e){a("b29T")},null,null).exports,m=a("KoIP"),h=a("5+41"),p={components:{SelectTree:i.a,TreeSelect:f},data:function(){return{categories:[],treeData:[],templates:[],defaultCagegory:{id:0,name:"顶级栏目"},config:{value:"id",label:"name",children:"children"},editParams:{status:1,parentId:0},fileList:[],multFileList:[]}},created:function(){this.getCategorys(),this.getTemplates()},computed:{editTypeChange:function(){return this.editType}},watch:{},methods:{getCategorys:function(){var e=this;m.a.tree().then(function(t){e.categories=t.data,e.treeData=[{id:0,name:"顶级栏目"}].concat(l()(t.data))})},getTemplates:function(){var e=this;h.a.fileList().then(function(t){e.templates=t.data})},nodeClick:function(e){this.editParams.parentId=e.id},save:function(e){var t=this;return this.editParams.name?this.editParams.parentId||0==this.editParams.parentId?this.editParams.listPage?this.editParams.detailPage?(this.editParams.icon=this.fileList.map(function(e){return e.url}).join(""),this.editParams.imgs=this.multFileList.map(function(e){return e.url}).join("||"),void(t.editParams.id?m.a.update(t.editParams).then(function(e){t.reset(),t.$message.success("保存成功")}):m.a.create(t.editParams).then(function(e){t.reset(),t.$message.success("保存成功"),t.getCategorys()}))):(this.$message.warning("请选择详情页"),!1):(this.$message.warning("请选择列表页"),!1):(this.$message.warning("请选择父栏目"),!1):(this.$message.warning("请填写名称"),!1)},edit:function(e){var t=this;if(this.editParams=e,e.icon){var a={};a.name=e.icon.split("@@")[1],a.url=e.icon,this.fileList=[a]}e.imgs&&e.imgs.split("||").map(function(e){var a={};a.name=e.split("@@")[1],a.url=e,t.multFileList.push(a)})},del:function(e){var t=this;m.a.delete(e.id).then(function(e){t.$confirm("此操作将永久删除该数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$message.success("已删除"),t.getCategorys()}).catch(function(){})})},statusChange:function(e){m.a.update({id:e.id,status:e.status}).then(function(e){})},reset:function(e){this.editParams={status:1,parentId:0},this.multFileList=[],this.fileList=[]},onSuccess:function(e,t,a){t.url=e.data.url,this.fileList=a},onMultSuccess:function(e,t,a){t.url=e.data.url,this.multFileList=a},handleRemove:function(e,t){this.fileList=t},handleMultRemove:function(e,t){this.multFileList=t}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticClass:"mb20",attrs:{xl:6,lg:6,md:10,sm:24,xs:24}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("栏目编辑")])]),e._v(" "),a("div",[a("el-form",{ref:"categoryForm",staticClass:"vertical-form",attrs:{model:e.editParams,"label-position":"left","label-width":"60px"}},[a("el-tabs",{attrs:{value:"basic"}},[a("el-tab-pane",{attrs:{label:"基础信息",name:"basic"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{prop:"name",placeholder:"名称"},model:{value:e.editParams.name,callback:function(t){e.$set(e.editParams,"name",t)},expression:"editParams.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"父栏目"}},[e.categories.length>0?a("tree-select",{attrs:{props:e.config,data:e.treeData,defaultOption:e.defaultCagegory},on:{"node-click":e.nodeClick},model:{value:e.editParams.parentId,callback:function(t){e.$set(e.editParams,"parentId",t)},expression:"editParams.parentId"}}):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"路径"}},[a("el-input",{attrs:{placeholder:"访问路径"},model:{value:e.editParams.path,callback:function(t){e.$set(e.editParams,"path",t)},expression:"editParams.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editParams.type,callback:function(t){e.$set(e.editParams,"type",t)},expression:"editParams.type"}},[a("el-option",{attrs:{label:"导航",value:1}}),e._v(" "),a("el-option",{attrs:{label:"分类",value:2}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"列表页"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editParams.listPage,callback:function(t){e.$set(e.editParams,"listPage",t)},expression:"editParams.listPage"}},e._l(e.templates,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"详情页"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.editParams.detailPage,callback:function(t){e.$set(e.editParams,"detailPage",t)},expression:"editParams.detailPage"}},e._l(e.templates,function(e){return a("el-option",{key:e.name,attrs:{label:e.name,value:e.name}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"顺序"}},[a("el-input",{attrs:{prop:"sort",placeholder:"顺序"},model:{value:e.editParams.sort,callback:function(t){e.$set(e.editParams,"sort",t)},expression:"editParams.sort"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.editParams.status,callback:function(t){e.$set(e.editParams,"status",t)},expression:"editParams.status"}},[a("el-radio",{attrs:{label:1}},[e._v("显示")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("隐藏")])],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"高级设置",name:"advance"}},[a("el-form-item",{attrs:{label:"副标题"}},[a("el-input",{attrs:{prop:"alias",placeholder:"副标题"},model:{value:e.editParams.alias,callback:function(t){e.$set(e.editParams,"alias",t)},expression:"editParams.alias"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"链接"}},[a("el-input",{attrs:{prop:"outLink",placeholder:"外部链接"},model:{value:e.editParams.outLink,callback:function(t){e.$set(e.editParams,"outLink",t)},expression:"editParams.outLink"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"关键字"}},[a("el-input",{attrs:{prop:"keywords",placeholder:"SEO关键字"},model:{value:e.editParams.keywords,callback:function(t){e.$set(e.editParams,"keywords",t)},expression:"editParams.keywords"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"SEO描述"},model:{value:e.editParams.description,callback:function(t){e.$set(e.editParams,"description",t)},expression:"editParams.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"图标"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/admin/upload/image","on-remove":e.handleRemove,"on-success":e.onSuccess,"file-list":e.fileList,limit:1,"list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"多图"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"/api/admin/upload/image","on-remove":e.handleMultRemove,"on-success":e.onMultSuccess,"file-list":e.multFileList,multiple:"","list-type":"picture"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.save()}}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.reset()}}},[e._v("重置")])],1)],1)],1)])],1),e._v(" "),a("el-col",{staticClass:"mb20",attrs:{xl:18,lg:18,md:14,sm:24,xs:24}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("栏目分类")])]),e._v(" "),a("div",[a("vxe-table",{ref:"xTree",attrs:{"tree-config":"","highlight-hover-row":"",border:!1,"edit-config":{trigger:"click",mode:"cell"},data:e.categories}},[a("vxe-table-column",{attrs:{field:"name",title:"名称","tree-node":""}}),e._v(" "),a("vxe-table-column",{attrs:{field:"id",title:"Id",width:"80"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"type",title:"类型",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(1==t.row.type?"导航":"分类"))]}}])}),e._v(" "),a("vxe-table-column",{attrs:{field:"path",title:"访问路径"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"listPage",title:"列表页"}}),e._v(" "),a("vxe-table-column",{attrs:{field:"detailPage",title:"详情页"}}),e._v(" "),a("vxe-table-column",{attrs:{title:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(a){return e.statusChange(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),e._v(" "),a("vxe-table-column",{attrs:{field:"sort",title:"顺序",width:"80","edit-render":{name:"input"}}}),e._v(" "),a("vxe-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.del(t.row)}}},[e._v("删除")])]}}])})],1)],1)])],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(p,v,!1,function(e){a("9q7c")},null,null);t.default=g.exports},Qg02:function(e,t){},b29T:function(e,t){}});