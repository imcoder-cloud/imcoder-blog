(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33a589ba","chunk-215a313a"],{"011e":function(e,t,a){"use strict";var r=a("b775"),i="/api/admin/extField",n={findAll:function(e){return Object(r["a"])({url:"".concat(i),params:e,method:"get"})},page:function(e){return Object(r["a"])({url:"".concat(i,"/page-plus"),params:e,method:"get"})},get:function(e){return Object(r["a"])({url:"".concat(i,"/").concat(e),method:"get"})},getExtFields:function(e){return Object(r["a"])({url:"".concat(i,"/getByCategoryIds"),params:e,method:"get"})},create:function(e){return Object(r["a"])({url:"".concat(i),data:e,method:"post"})},update:function(e){return Object(r["a"])({url:"".concat(i),data:e,method:"put"})},delete:function(e){return Object(r["a"])({url:"".concat(i,"/").concat(e),method:"delete"})}};t["a"]=n},6407:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-pagination",{attrs:{background:!1,"current-page":e.pageNum,"page-sizes":[5,10,20,30,40,50],"page-size":e.pageSize,layout:e.optionsArr.join(","),total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})},i=[],n={props:{pageSize:{default:10},pageNum:{default:1},total:{default:0}},data:function(){return{optionsArr:["total","sizes","prev","pager","next","jumper"]}},methods:{handleSizeChange:function(e){this.$emit("sizeChange",e)},handleCurrentChange:function(e){this.$emit("currentChange",e)}}},l=n,s=a("4023"),o=Object(s["a"])(l,r,i,!1,null,null,null);t["a"]=o.exports},"651a":function(e,t,a){"use strict";a("fe59"),a("053b"),a("08ba");var r=a("b775"),i="/api/admin/category",n={};function l(e,t){t.forEach((function(t){e.key===t.parentId&&(e.children||(e.children=[]),e.children.push({key:t.id,title:t.name,isLeaf:!1}))})),e.children?e.children.forEach((function(e){return l(e,t)})):e.isLeaf=!0}n.findAll=function(e){return Object(r["a"])({url:"".concat(i),params:e,method:"get"})},n.page=function(e){return Object(r["a"])({url:"".concat(i,"/page"),params:e,method:"get"})},n.get=function(e){return Object(r["a"])({url:"".concat(i,"/").concat(e),method:"get"})},n.tree=function(){return Object(r["a"])({url:"".concat(i,"/tree"),method:"get"})},n.create=function(e){return Object(r["a"])({url:"".concat(i,"/save"),data:e,method:"post"})},n.update=function(e){return Object(r["a"])({url:"".concat(i,"/update"),data:e,method:"put"})},n.delete=function(e){return Object(r["a"])({url:"".concat(i,"/").concat(e),method:"delete"})},n.concreteTree=function(e){var t={key:0,title:"top",children:[]};return l(t,e),t.children},t["a"]=n},"6bf8":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tree",{ref:"categoryTree",attrs:{"highlight-current":!0,data:e.categories,props:e.props},on:{"node-click":e.handleNodeClick}})},i=[],n=a("651a"),l={created:function(){this.getCategoryTree()},data:function(){return{categories:[],props:{children:"children",label:"name"}}},methods:{getCategoryTree:function(){var e=this;n["a"].tree().then((function(t){e.categories=t.data,e.categories.unshift({id:null,name:"全部"})}))},handleNodeClick:function(e,t,a){this.$emit("node-click",e)}}},s=l,o=a("4023"),c=Object(o["a"])(s,r,i,!1,null,null,null);t["default"]=c.exports},d081:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{staticClass:"mb20",attrs:{xl:5,lg:6,md:10,sm:24,xs:24}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("选择栏目")])]),a("category-tree",{on:{"node-click":e.handleNodeClick}})],1)],1),a("el-col",{staticClass:"mb20",attrs:{xl:19,lg:18,md:14,sm:24,xs:24}},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("字段列表")])]),a("div",[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"字段名称"}},[a("el-input",{attrs:{placeholder:"字段名称"},model:{value:e.queryParams.title,callback:function(t){e.$set(e.queryParams,"title",t)},expression:"queryParams.title"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getExtField()}}},[e._v("查询")]),e.addPermission?a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showForm(null)}}},[e._v("新增")]):e._e()],1)],1)],1),a("div",{staticStyle:{padding:"20px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{"margin-bottom":"20px"},attrs:{data:e.fields,"element-loading-background":"rgba(0, 0, 0, 0.3)","element-loading-text":"数据正在加载中","element-loading-spinner":"el-icon-loading"}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60"}}),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"90"}}),a("el-table-column",{attrs:{prop:"field",label:"字段"}}),a("el-table-column",{attrs:{prop:"categoryName",label:"栏目"}}),a("el-table-column",{attrs:{prop:"size",label:"长度"}}),a("el-table-column",{attrs:{prop:"value",label:"字段值","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"字段所属"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s("content"==t.row.struct?"内容":"栏目"))]}}])}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"180"}}),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.editPermission?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.showForm(t.row)}}},[e._v("修改")]):e._e(),e.delPermission?a("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{title:"确定删除本条数据吗？删除后不可恢复。",cancelButtonType:"default"},on:{onConfirm:function(a){return e.del(t.row)}}},[a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1):e._e()]}}])})],1),a("pagination",{attrs:{pageNum:e.queryParams.pageNum,pageSize:e.queryParams.pageSize,total:e.total},on:{sizeChange:e.handleSizeChange,currentChange:e.handleCurrentChange}})],1)])],1)],1),a("el-dialog",{attrs:{title:"新增字段",width:"500px",visible:e.showAddForm},on:{"update:visible":function(t){e.showAddForm=t}}},[a("el-form",{attrs:{model:e.editParams,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"名称：建议2-4字以内"},model:{value:e.editParams.name,callback:function(t){e.$set(e.editParams,"name",t)},expression:"editParams.name"}})],1),a("el-form-item",{attrs:{label:"字段"}},[a("el-input",{attrs:{disabled:null!=e.editParams.id,autocomplete:"off",placeholder:"以字母开头，下划线分隔，例：price"},model:{value:e.editParams.field,callback:function(t){e.$set(e.editParams,"field",t)},expression:"editParams.field"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{disabled:null!=e.editParams.id,placeholder:"请选类型"},model:{value:e.editParams.type,callback:function(t){e.$set(e.editParams,"type",t)},expression:"editParams.type"}},[a("el-option",{attrs:{label:"单行文本",value:"input"}}),a("el-option",{attrs:{label:"多行文本",value:"textarea"}}),a("el-option",{attrs:{label:"下拉列表",value:"select"}}),a("el-option",{attrs:{label:"日期选择",value:"date"}}),a("el-option",{attrs:{label:"单选按钮",value:"radio"}}),a("el-option",{attrs:{label:"多选按钮",value:"checkbox"}}),a("el-option",{attrs:{label:"图片上传",value:"image"}}),a("el-option",{attrs:{label:"附件上传",value:"file"}})],1)],1),a("el-form-item",{attrs:{label:"长度"}},[a("el-input",{attrs:{autocomplete:"off",disabled:null!=e.editParams.id,placeholder:"字段长度"},model:{value:e.editParams.size,callback:function(t){e.$set(e.editParams,"size",t)},expression:"editParams.size"}})],1),a("el-form-item",{attrs:{label:"字段值"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"只在单选、多选、下拉选择时有效"},model:{value:e.editParams.value,callback:function(t){e.$set(e.editParams,"value",t)},expression:"editParams.value"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"字段描述"},model:{value:e.editParams.description,callback:function(t){e.$set(e.editParams,"description",t)},expression:"editParams.description"}})],1),a("el-form-item",{attrs:{label:"字段所属"}},[a("el-radio-group",{model:{value:e.editParams.struct,callback:function(t){e.$set(e.editParams,"struct",t)},expression:"editParams.struct"}},[a("el-radio",{attrs:{label:"content"}},[e._v("内容")]),a("el-radio",{attrs:{label:"category"}},[e._v("栏目")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.showAddForm=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveField}},[e._v("确定")])],1)],1)],1)},i=[],n=(a("ecb4"),a("053b"),a("6bf8")),l=a("6407"),s=a("011e"),o=a("4360"),c={components:{CategoryTree:n["default"],Pagination:l["a"]},data:function(){return{addPermission:!1,editPermission:!1,delPermission:!1,tableLoading:!1,fields:[],queryParams:{pageNum:1,pageSize:10},total:0,showAddForm:!1,editParams:{size:255,type:"input",struct:"content"}}},created:function(){this.addPermission=o["a"].state.user.permissions.indexOf(200102001)>-1,this.editPermission=o["a"].state.user.permissions.indexOf(200102002)>-1,this.delPermission=o["a"].state.user.permissions.indexOf(200102003)>-1,this.getExtField()},methods:{getExtField:function(){var e=this;""==this.queryParams.name&&(this.queryParams.name=null),this.tableLoading=!0,s["a"].page(this.queryParams).then((function(t){e.tableLoading=!1,e.fields=t.data.records,e.total=t.data.total}))},handleNodeClick:function(e){this.queryParams.categoryId=e.id,this.editParams.categoryId=e.id,this.getExtField()},handleSizeChange:function(e){this.queryParams.pageSize=e,this.getExtField()},handleCurrentChange:function(e){this.queryParams.pageNum=e,this.getExtField()},showForm:function(e){if(e&&(this.editParams=e),!this.editParams.categoryId)return this.$message.warning("请选择栏目分类"),!1;this.showAddForm=!0},saveField:function(){var e=this;return this.editParams.name?this.editParams.field?this.editParams.size?"select"!=this.editParams.type&&"radio"!=this.editParams.type&&"checkbox"!=this.editParams.type||this.editParams.value?void(this.editParams.id?s["a"].update(this.editParams).then((function(t){e.$message.success("保存成功"),e.reset(),e.showAddForm=!1,e.getExtField()})):s["a"].create(this.editParams).then((function(t){e.$message.success("保存成功"),e.reset(),e.showAddForm=!1,e.getExtField()}))):(this.$message.warning("请填写字段值"),!1):(this.$message.warning("请填写长度"),!1):(this.$message.warning("请填写字段"),!1):(this.$message.warning("请填写名称"),!1)},del:function(e){var t=this;s["a"].delete(e.id).then((function(e){t.$message.success("删除成功"),t.getExtField()}))},reset:function(){this.editParams.id=null,this.editParams.size=255,this.editParams.type="input",this.editParams.name="",this.editParams.field=""}}},d=c,u=a("4023"),m=Object(u["a"])(d,r,i,!1,null,null,null);t["default"]=m.exports}}]);
//# sourceMappingURL=chunk-33a589ba.343b2d23.js.map